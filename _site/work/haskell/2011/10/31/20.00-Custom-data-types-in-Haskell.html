<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Custom data types in Haskell</title>
        <meta name="description" content="Rodney's Blog">
        <meta name="author" content="Rodney Gomes">

        <link rel="alternate"
              type="application/rss+xml"
              title="Rodney's Corner RSS Feed"
              href="http://feeds.feedburner.com/rlgomesgithubcom/feed"/>

        <link href="/css/bootstrap.css" rel="stylesheet">
        <link href="/css/main.css" rel="stylesheet"/>
    </head>
    <body>

    <div class="topbar">
      <div class="fill">
        <div class="container">
          <a class="brand" href="/">Rodney's Corner</a>
          <ul class="nav">
            <li class="active"><a href="/">Blog</a></li>
            <li><a href="/archive.html">Archive</a></li>
            <li><a href="/about.html">About</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="content">
        <div class="page-header">
          <h1>Custom data types in Haskell</h1>
        </div>
        <div class="row">
          <div class="span10">
             <article>
                   <div id="post.body"><p>Hopefully after the first post in this series you can quickly write up simple functions over existing Haskell types and also understand basic polymorphism as well as funciton composition. We&#8217;ll now start digging into creating custom types and how to handle these in our functions. Lets start by creating a Tree type:</p>
<div class='highlight'><pre><code class='hs'><span class='kr'>data</span> <span class='kt'>Tree</span> <span class='n'>a</span> <span class='ow'>=</span> <span class='kt'>Leaf</span> <span class='o'>|</span> <span class='kt'>Node</span> <span class='n'>a</span> <span class='p'>(</span><span class='kt'>Tree</span> <span class='n'>a</span><span class='p'>)</span> <span class='p'>(</span><span class='kt'>Tree</span> <span class='n'>b</span><span class='p'>)</span>
</code></pre>
</div>
<p>When defining elements of the type above you can do so in the following manner:</p>
<div class='highlight'><pre><code class='hs'><span class='nf'>sampleTree</span> <span class='ow'>=</span> <span class='kt'>Node</span> <span class='mi'>2</span> <span class='p'>(</span><span class='kt'>Node</span> <span class='mi'>1</span> <span class='kt'>Leaf</span> <span class='kt'>Leaf</span><span class='p'>)</span> <span class='p'>(</span><span class='kt'>Node</span> <span class='mi'>3</span> <span class='kt'>Leaf</span><span class='p'>)</span>
</code></pre>
</div>
<p>Which represents the Tree:</p>
<pre>
      2
     / \ 
    /   \
   1     3
  / \   / \
 *   * *   *
</pre>
<p>We now want to write a function that can calculate the maximum depth of a Tree and when we write this function we must not forget to handle all of the cases that compose the data type Tree. Which means handling the Leaf and handling the Node x y z, like so:</p>
<div class='highlight'><pre><code class='hs'><span class='nf'>maxdepth</span> <span class='ow'>::</span> <span class='kt'>Tree</span> <span class='n'>a</span> <span class='ow'>-&gt;</span> <span class='kt'>Int</span>
<span class='nf'>maxdepth</span> <span class='kt'>Leaf</span> <span class='ow'>=</span> <span class='mi'>0</span>
<span class='nf'>maxdepth</span> <span class='p'>(</span><span class='kt'>Node</span> <span class='kr'>_</span> <span class='n'>l</span> <span class='n'>r</span><span class='p'>)</span> <span class='ow'>=</span> <span class='mi'>1</span> <span class='o'>+</span> <span class='n'>max</span> <span class='p'>(</span><span class='n'>maxdepth</span> <span class='n'>l</span><span class='p'>)</span> <span class='p'>(</span><span class='n'>maxdepth</span> <span class='n'>r</span><span class='p'>)</span> 
</code></pre>
</div>
<p>As you can see pattern matching on your custom data type is extremely easy to read and is just like doing so with any built in type. We introduced the use of the _ variable which is how you handle variables when you don&#8217;t care to use them in your functions calculations. We&#8217;re using the <strong>max</strong> function from <strong>Prelude</strong> to handle calculating the maximum of those two possible choices in a <strong>Tree</strong>.</p>

<p>Lets look at how to print an existing tree with in Haskell. So firstly if you try to just show the current <strong>sampleTree</strong> you&#8217;ll find that ghci shell will actually complain it can&#8217;t show this new element:</p>
<console>
No instance for (Show (Tree Integer))
    arising from a use of `print'
Possible fix: add an instance declaration for (Show (Tree Integer))
In a stmt of an interactive GHCi command: print it
</console>
<p>The above error is basically trying to tell you that Haskell doesn&#8217;t know how to &#8220;show&#8221; the data type you just created. One easy thing to do is to just let Haskell derive a basic representation for your type by adding the following to the declaration of the type:</p>
<div class='highlight'><pre><code class='hs'><span class='kr'>data</span> <span class='kt'>Tree</span> <span class='n'>a</span> <span class='ow'>=</span> <span class='kt'>Leaf</span> <span class='o'>|</span> <span class='kt'>Node</span> <span class='n'>a</span> <span class='p'>(</span><span class='kt'>Tree</span> <span class='n'>a</span><span class='p'>)</span> <span class='p'>(</span><span class='kt'>Tree</span> <span class='n'>b</span><span class='p'>)</span>
    <span class='kr'>deriving</span> <span class='p'>(</span><span class='kt'>Show</span><span class='p'>)</span>
</code></pre>
</div>
<p>With that you can now get a simple representation of your data like so:</p>
<console>
Main> sampleTree
Node 1 (Node 2 Leaf Leaf) (Node 3 (Node 4 Leaf Leaf) Leaf)
</console>
<p>But you can also define exactly how you&#8217;d like to represent your trees. This is done by defining an instance of the class Show for your datatype and then defining the function <strong>show</strong> for your type, something like so:</p>
<div class='highlight'><pre><code class='hs'><span class='nf'>padding</span> <span class='ow'>::</span> <span class='p'>(</span><span class='kt'>Num</span> <span class='n'>a</span><span class='p'>)</span> <span class='ow'>=&gt;</span> <span class='n'>a</span> <span class='ow'>-&gt;</span> <span class='kt'>String</span>
<span class='nf'>padding</span> <span class='mi'>0</span> <span class='ow'>=</span> <span class='s'>&quot;&quot;</span>
<span class='nf'>padding</span> <span class='n'>n</span> <span class='ow'>=</span> <span class='s'>&quot; &quot;</span> <span class='o'>++</span> <span class='n'>padding</span><span class='p'>(</span><span class='n'>n</span><span class='o'>-</span><span class='mi'>1</span><span class='p'>)</span>

<span class='nf'>showTree</span> <span class='ow'>::</span> <span class='p'>(</span><span class='kt'>Show</span> <span class='n'>a</span><span class='p'>,</span> <span class='kt'>Num</span> <span class='n'>b</span><span class='p'>)</span> <span class='ow'>=&gt;</span> <span class='kt'>Tree</span> <span class='n'>a</span> <span class='ow'>-&gt;</span> <span class='n'>b</span> <span class='ow'>-&gt;</span> <span class='kt'>String</span>
<span class='nf'>showTree</span> <span class='kt'>Leaf</span> <span class='n'>n</span> <span class='ow'>=</span> <span class='p'>(</span><span class='n'>padding</span> <span class='n'>n</span><span class='p'>)</span> <span class='o'>++</span> <span class='s'>&quot;.&quot;</span>
<span class='nf'>showTree</span> <span class='p'>(</span><span class='kt'>Node</span> <span class='n'>a</span> <span class='n'>l</span> <span class='n'>r</span> <span class='p'>)</span> <span class='n'>n</span> <span class='ow'>=</span> <span class='kr'>let</span> <span class='n'>showl</span> <span class='ow'>=</span> <span class='n'>showTree</span> <span class='n'>l</span> <span class='p'>(</span><span class='n'>n</span><span class='o'>+</span><span class='mi'>4</span><span class='p'>)</span> <span class='kr'>in</span> 
                           <span class='kr'>let</span> <span class='n'>showr</span> <span class='ow'>=</span> <span class='n'>showTree</span> <span class='n'>r</span> <span class='p'>(</span><span class='n'>n</span><span class='o'>+</span><span class='mi'>4</span><span class='p'>)</span> <span class='kr'>in</span> 
                           <span class='kr'>let</span> <span class='n'>showc</span> <span class='ow'>=</span> <span class='p'>(</span><span class='n'>padding</span> <span class='n'>n</span><span class='p'>)</span> <span class='o'>++</span> <span class='p'>(</span><span class='n'>show</span> <span class='n'>a</span><span class='p'>)</span> <span class='kr'>in</span>
                           <span class='n'>showc</span> <span class='o'>++</span> <span class='s'>&quot;</span><span class='se'>\n</span><span class='s'>&quot;</span> <span class='o'>++</span> <span class='n'>showl</span> <span class='o'>++</span> <span class='s'>&quot;</span><span class='se'>\n</span><span class='s'>&quot;</span> <span class='o'>++</span> <span class='n'>showr</span>

<span class='kr'>instance</span> <span class='p'>(</span><span class='kt'>Show</span> <span class='n'>a</span><span class='p'>)</span> <span class='ow'>=&gt;</span> <span class='kt'>Show</span> <span class='p'>(</span><span class='kt'>Tree</span> <span class='n'>a</span><span class='p'>)</span> <span class='kr'>where</span>
    <span class='n'>show</span> <span class='n'>a</span> <span class='ow'>=</span> <span class='n'>showTree</span> <span class='n'>a</span> <span class='mi'>0</span>
</code></pre>
</div>
<p>I&#8217;ve introduced here the concept of typeclasses, they are heavily used in conjunction with polymorphism to better describe the type of elements that can be used with the current function. Typeclasses seem like class definitions but they&#8217;re much more powerful in the sense that you are defining an abstract operation that needs to be defined per type that wants to be usable by certain functions. In the code above you&#8217;ll notice how the <strong>padding</strong> function is expressing that it can accept any <strong>a</strong> as long as its an implementation of the typeclass <strong>Num</strong>.</p>

<p>Basically you&#8217;re telling Haskell that to <strong>show</strong> a <strong>Tree a</strong> type you want Haskell to represent it in the manner a specific manner by giving Haskell the definition of the <strong>show</strong> function you&#8217;d rather use. Now when we try to reference our <strong>sampleTree</strong> you&#8217;ll get a more readable representation like so:</p>
<console>
Main> sampleTree
1
    2
        .
        .
    3
        4
            .
            .
        .
</console>
<p>If we wanted we could even extend this <strong>show</strong> implementation to draw a few ASCII lines and make the tree a bit easier to read. We&#8217;ll leave that as an exercise for the reader.</p>

<p>Lets find something more interesting function to write and we&#8217;ll start by writing up a <strong>insert</strong> function takes a Tree and an element and inserts the Tree with the new element inserted while at least making sure that the nodes are in order in the tree so that if we print the tree in order it will print the elements in order</p>
<div class='highlight'><pre><code class='hs'><span class='nf'>insert</span> <span class='ow'>::</span> <span class='p'>(</span><span class='kt'>Ord</span> <span class='n'>a</span><span class='p'>)</span> <span class='ow'>=&gt;</span> <span class='n'>a</span> <span class='ow'>-&gt;</span> <span class='kt'>Tree</span> <span class='n'>a</span> <span class='ow'>-&gt;</span> <span class='kt'>Tree</span> <span class='n'>a</span>
<span class='nf'>insert</span> <span class='n'>a</span> <span class='kt'>Leaf</span> <span class='ow'>=</span> <span class='kt'>Node</span> <span class='n'>a</span> <span class='kt'>Leaf</span> <span class='kt'>Leaf</span>
<span class='nf'>insert</span> <span class='n'>a</span> <span class='p'>(</span><span class='kt'>Node</span> <span class='n'>b</span> <span class='n'>l</span> <span class='n'>r</span><span class='p'>)</span> <span class='ow'>=</span> <span class='kr'>if</span> <span class='n'>a</span> <span class='o'>&lt;</span> <span class='n'>b</span>
                            <span class='kr'>then</span> <span class='kt'>Node</span> <span class='n'>b</span> <span class='p'>(</span><span class='n'>insert</span> <span class='n'>a</span> <span class='n'>l</span><span class='p'>)</span> <span class='n'>r</span>
                            <span class='kr'>else</span> <span class='kt'>Node</span> <span class='n'>b</span> <span class='n'>l</span> <span class='p'>(</span><span class='n'>insert</span> <span class='n'>a</span> <span class='n'>r</span><span class='p'>)</span>
</code></pre>
</div>
<p>Again we used the typeclass Ord which is define as:</p>
<div class='highlight'><pre><code class='hs'><span class='kr'>class</span>  <span class='p'>(</span><span class='kt'>Eq</span> <span class='n'>a</span><span class='p'>)</span> <span class='ow'>=&gt;</span> <span class='kt'>Ord</span> <span class='n'>a</span>  <span class='kr'>where</span>
   <span class='n'>compare</span>              <span class='ow'>::</span> <span class='n'>a</span> <span class='ow'>-&gt;</span> <span class='n'>a</span> <span class='ow'>-&gt;</span> <span class='kt'>Ordering</span>
   <span class='p'>(</span><span class='o'>&lt;</span><span class='p'>),</span> <span class='p'>(</span><span class='o'>&lt;=</span><span class='p'>),</span> <span class='p'>(</span><span class='o'>&gt;=</span><span class='p'>),</span> <span class='p'>(</span><span class='o'>&gt;</span><span class='p'>)</span> <span class='ow'>::</span> <span class='n'>a</span> <span class='ow'>-&gt;</span> <span class='n'>a</span> <span class='ow'>-&gt;</span> <span class='kt'>Bool</span>
   <span class='n'>max</span><span class='p'>,</span> <span class='n'>min</span>             <span class='ow'>::</span> <span class='n'>a</span> <span class='ow'>-&gt;</span> <span class='n'>a</span> <span class='ow'>-&gt;</span> <span class='n'>a</span>

        <span class='c1'>-- Minimal complete definition:</span>
        <span class='c1'>--      (&lt;=) or compare</span>
        <span class='c1'>-- Using compare can be more efficient for complex types.</span>
    <span class='n'>compare</span> <span class='n'>x</span> <span class='n'>y</span>
         <span class='o'>|</span> <span class='n'>x</span> <span class='o'>==</span> <span class='n'>y</span>    <span class='ow'>=</span>  <span class='kt'>EQ</span>
         <span class='o'>|</span> <span class='n'>x</span> <span class='o'>&lt;=</span> <span class='n'>y</span>    <span class='ow'>=</span>  <span class='kt'>LT</span>
         <span class='o'>|</span> <span class='n'>otherwise</span> <span class='ow'>=</span>  <span class='kt'>GT</span>

    <span class='n'>x</span> <span class='o'>&lt;=</span> <span class='n'>y</span>           <span class='ow'>=</span>  <span class='n'>compare</span> <span class='n'>x</span> <span class='n'>y</span> <span class='o'>/=</span> <span class='kt'>GT</span>
    <span class='n'>x</span> <span class='o'>&lt;</span>  <span class='n'>y</span>           <span class='ow'>=</span>  <span class='n'>compare</span> <span class='n'>x</span> <span class='n'>y</span> <span class='o'>==</span> <span class='kt'>LT</span>
    <span class='n'>x</span> <span class='o'>&gt;=</span> <span class='n'>y</span>           <span class='ow'>=</span>  <span class='n'>compare</span> <span class='n'>x</span> <span class='n'>y</span> <span class='o'>/=</span> <span class='kt'>LT</span>
    <span class='n'>x</span> <span class='o'>&gt;</span>  <span class='n'>y</span>           <span class='ow'>=</span>  <span class='n'>compare</span> <span class='n'>x</span> <span class='n'>y</span> <span class='o'>==</span> <span class='kt'>GT</span>

<span class='c1'>-- note that (min x y, max x y) = (x,y) or (y,x)</span>
    <span class='n'>max</span> <span class='n'>x</span> <span class='n'>y</span> 
         <span class='o'>|</span> <span class='n'>x</span> <span class='o'>&gt;=</span> <span class='n'>y</span>    <span class='ow'>=</span>  <span class='n'>x</span>
         <span class='o'>|</span> <span class='n'>otherwise</span> <span class='ow'>=</span>  <span class='n'>y</span>
    <span class='n'>min</span> <span class='n'>x</span> <span class='n'>y</span>
         <span class='o'>|</span> <span class='n'>x</span> <span class='o'>&lt;</span>  <span class='n'>y</span>    <span class='ow'>=</span>  <span class='n'>x</span>
         <span class='o'>|</span> <span class='n'>otherwise</span> <span class='ow'>=</span>  <span class='n'>y</span>
</code></pre>
</div>
<p>Basically the definition tells you that defining the <strong>compare</strong> function is enough to for the other functions be inferred from.</p>

<p>One last thing about defining data types is the ability to create synonyms for existing types. This is done using the <strong>type</strong> keyword and allows you to make your functions more readable. Here are a few examples:</p>
<div class='highlight'><pre><code class='hs'><span class='kr'>type</span> <span class='kt'>String</span> <span class='ow'>=</span> <span class='p'>[</span><span class='kt'>Char</span><span class='p'>]</span>

<span class='kr'>type</span> <span class='kt'>Name</span> <span class='ow'>=</span> <span class='kt'>String</span>
<span class='kr'>data</span> <span class='kt'>Address</span> <span class='ow'>=</span> <span class='kt'>None</span> <span class='o'>|</span> <span class='kt'>Addr</span> <span class='kt'>String</span>
<span class='kr'>type</span> <span class='kt'>Person</span> <span class='ow'>=</span> <span class='p'>(</span><span class='kt'>Name</span><span class='p'>,</span><span class='kt'>Address</span><span class='p'>)</span>

<span class='kr'>type</span> <span class='kt'>StringList</span> <span class='ow'>=</span> <span class='p'>[</span><span class='kt'>String</span><span class='p'>]</span>
</code></pre>
</div></div>
             </article>
             <hr/>
             <div id="disqus_thread"></div>
             <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'rodneyscorner'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
              </script>
              <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
              <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
          </div>
          <div class="span4">
            
                <h2>Related Posts</h2>
                <ul>
                    
                    <li><a href="/work/haskell/2011/11/14/20.30-Optimizing-Haskell-Programs.html">Optimizing Haskell Programs</a></li>
                    
                    <li><a href="/work/haskell/2011/11/13/13.00-Writing-wc-command-line-tool-in-Haskell.html">Writing wc command line tool in Haskell</a></li>
                    
                    <li><a href="/work/haskell/2011/11/08/22.30-Advanced-Typeclasses.html">Advanced Typeclasses</a></li>
                    
                    <li><a href="/work/haskell/2011/11/01/23.00-Higher-order-functions-in-Haskell.html">Higher order functions in Haskell</a></li>
                    
                    <li><a href="/work/haskell/2011/10/30/20.00-haskell-basics.html">Haskell Basics</a></li>
                    
                </ul>
            
          </div>
        </div>
      </div>
      <footer>
        <div style="text-align: right">Powered by <a href="http://jekyllrb.com/">Jekyll</a> &amp; <a href="http://twitter.github.com/bootstrap/index.html">Bootstrap</a></div>
        <div style="text-align: right">Last Updated: Wed May 16 16:16:15 -0700 2012</div>
      </footer>
    </div> <!-- /container -->
</html>
